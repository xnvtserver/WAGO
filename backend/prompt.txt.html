<div id="MAIN-PROMPT">
Update my components to use the store

  remember my application is structured into three interconnected layers‚ÄîFrontend (Vue.js), Backend (Node.js with Express.js), and Database (via Migrations + ORM like Sequelize/TypeORM).
  ‚úÖ 1. Frontend (Vue.js)
  UI Layer: Built with Vue.js, displays data and handles user interaction.
  API Calls: Uses axios or fetch to send requests to the backend.
  State Management: Likely uses Vuex or Pinia to manage application state.
  Routing: Vue Router maps URL paths to different components/views (like store info, tax settings).
  Forms & CRUD: Interfaces to create/read/update/delete data that mirrors the backend model structure.
  ‚úÖ 2. Backend (Node.js + Express.js)
  API Layer: Express.js handles HTTP requests (GET, POST, PUT, DELETE).
  Routing: Each route maps to specific controller logic.
  Business Logic: Handles validations, authentication (e.g., authMiddleware.js), and error handling.
  ORM Models: Models (via Sequelize/TypeORM) represent database tables.
  ‚úÖ 3. Database + Migrations
  Schema Management: Migrations define and evolve your DB schema (tables, fields, relationships).
  Consistency: Ensures structure aligns with backend expectations and frontend data needs.
  üîó Core Entities & Their Relationships
  1. Users
  Represents all users (owners, employees, customers).
  Key Fields: name, email, password_hash, role, phone.
  Relationships:
  Linked as owners in the shops table via owner_id.
  Linked in employee_profiles as both employee (user_id) and manager (managed_by).
  Linked in shop_permissions for assigning roles and access.
  Linked in price_history as changed_by.
  2. Shops
  Represents a shop or store, owned by a user.
  Key Fields: name, location, status, owner_id.
  Relationships:
  References a user as owner.
  Linked with shop_products for inventory association.
  Linked with shop_permissions for user access roles.
  Linked with price_history and promotions.
  3. Products
  Represents global product catalog (not shop-specific).
  Key Fields: name, sku, barcode, brand, category.
  Relationships:
  Linked via shop_products to assign availability and pricing per shop.
  Linked in price_history for tracking pricing changes.
  4. Shop_Products (Junction Table)
  Many-to-many relationship between shops and products.
  Stores product pricing & stock per shop.
  Key Fields: retail_price, wholesale_price, purchase_price, stock.
  5. Employee_Profiles
  Associates a user (employee) with their manager (also a user).
  Helps distinguish employees in the users table.
  Fields: user_id, managed_by, is_active.
  6. Shop_Permissions
  Grants access to users within a specific shop.
  Fields:
  role within the shop: manager, cashier, inventory_staff.
  permissions: Array of permission_type enums like view_dashboard, etc
  7. Price_History
  Tracks price changes for products per shop.
  Key Fields:
  product_id, shop_id, price_type (retail/wholesale/purchase),
  old_price, new_price, changed_by (user who made the change).
  8. Promotions
  Store-specific promotional offers.
  Key Fields: shop_id, offer_text, start_date, end_date, discount_percentage.
  ‚öôÔ∏è Enums and Custom Types
  permission_type ENUM:
  Defines specific allowed actions: view_dashboard, manage_inventory, etc.
  Used in: shop_permissions.permissions as an array (permission_type[]).
  üìä Indexes
  Added on foreign key-heavy fields for performance:
  shops.owner_id
  shop_products.shop_id, shop_products.product_id
  price_history.product_id, price_history.price_type
  üìà Entity Dependency Flow
  users ‚Üí shops ‚Üí shop_products ‚Üí products
       ‚Üò          ‚Üò
      employee_profiles
       ‚Üò
      shop_permissions
       ‚Üò
      price_history ‚Üí (also ‚Üí users, products, shops)
                       ‚Üò
                    promotions ‚Üí shops
  üß© Frontend/Backend/Data Flow Impact
  Frontend (Vue.js) uses API calls to:
  View and manage shops, products, and permissions (based on roles).
  Show shop-specific stock, price history, and apply promotions.
  Backend (Node.js):
  Reads and writes to the above tables using ORMs like Sequelize.
  Enforces relationships and constraints defined here
  Database migrations:
  Define the shape and rules of the data layer ‚Äî the source of truth for model definitions in backend and reflected data structures in the frontend.
  üîÅ Frontend-Backend-Database Flow
  User acts on the frontend (e.g., submits a form).
  Frontend sends API request to backend.
  Backend processes request ‚Üí uses models ‚Üí interacts with the database.
  Database returns data or confirmation ‚Üí backend sends JSON response.
  Frontend updates UI based on the received data.
  üí° In Essence:
  Migrations define structure
  Backend models & routes operate on that structure
  Frontend visualizes and manipulates the structured data
</div>





<div>
i will provide my billing vue pages (  total 3 vue pages  => 1)<!-- front-end/src/views/BillingView.vue-->
<template>
  <div class="container mx-auto px-4 py-8">
    <!-- Header -->
    <header class="mb-8 text-center">
      <h1 class="text-3xl font-bold text-green-700">{{ shop.name }}</h1>
      <p class="text-gray-600">{{ shop.location }} | ‡¥´‡µã‡µ∫: {{ shop.phone }}</p>
      <div v-if="shop.current_offer" class="mt-4 bg-green-100 p-3 rounded-lg">
        <p class="text-green-800 font-medium">‡¥á‡¥®‡µç‡¥®‡¥§‡µç‡¥§‡µÜ ‡¥ì‡¥´‡µº: {{ shop.current_offer }}</p>
      </div>
    </header>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
      <!-- Products Section -->
      <div class="lg:col-span-2">
        <div class="bg-white rounded-lg bill-card p-4 mb-6">
          <h2 class="text-xl font-bold text-green-800 mb-4 border-b pb-2">‡¥™‡¥ö‡µç‡¥ö‡¥ï‡µç‡¥ï‡¥±‡¥ø‡¥ï‡µæ</h2>
          <div v-if="loading" class="text-center py-8">
            <i class="fas fa-spinner fa-spin text-2xl text-blue-500"></i>
            <p class="mt-2">Loading products...</p>
          </div>
          <div v-else class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div v-for="product in products" :key="product.id" class="border rounded-lg p-3">
              <div class="flex justify-between items-start">
                <div>
                  <h3 class="font-bold text-gray-800">{{ product.name }}</h3>
                  <p class="text-sm text-gray-600">‚Çπ{{ product.price.toFixed(2) }} / ‡¥ï‡¥ø‡¥≤‡µã</p>
                </div>
                <div class="flex items-center">
                  <button 
                    @click="decrementQuantity(product.id)"
                    class="w-8 h-8 bg-gray-200 rounded flex items-center justify-center"
                    :disabled="getProductQuantity(product.id) <= 0"
                  >
                    <i class="fas fa-minus"></i>
                  </button>
                  <input 
                    type="number" 
                    v-model.number="quantities[product.id]"
                    @change="updateQuantity(product.id, quantities[product.id])"
                    min="0"
                    step="0.1"
                    class="w-16 mx-2 text-center border rounded"
                  />
                  <button 
                    @click="incrementQuantity(product.id)"
                    class="w-8 h-8 bg-green-200 rounded flex items-center justify-center"
                  >
                    <i class="fas fa-plus"></i>
                  </button>
                </div>
              </div>
              <div class="mt-2 flex justify-between">
                <span class="text-sm text-gray-500">‡¥Æ‡µä‡¥§‡µç‡¥§‡¥Ç: </span>
                <span class="font-medium">‚Çπ{{ (getProductQuantity(product.id) * product.price).toFixed(2) }}</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Customer Details -->
        <div class="bg-white rounded-lg bill-card p-4">
          <h2 class="text-xl font-bold text-green-800 mb-4 border-b pb-2">‡¥â‡¥™‡¥≠‡µã‡¥ï‡µç‡¥§‡µÉ ‡¥µ‡¥ø‡¥µ‡¥∞‡¥ô‡µç‡¥ô‡µæ</h2>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <label class="block text-gray-700 mb-1">‡¥™‡µá‡¥∞‡µç</label>
              <input v-model="customer.name" type="text" class="w-full border rounded px-3 py-2">
            </div>
            <div>
              <label class="block text-gray-700 mb-1">‡¥´‡µã‡µ∫ ‡¥®‡¥Æ‡µç‡¥™‡µº</label>
              <input v-model="customer.phone" type="text" class="w-full border rounded px-3 py-2">
            </div>
            <div class="md:col-span-2">
              <label class="block text-gray-700 mb-1">‡¥µ‡¥ø‡¥≤‡¥æ‡¥∏‡¥Ç</label>
              <textarea v-model="customer.address" class="w-full border rounded px-3 py-2" rows="2"></textarea>
            </div>
          </div>
        </div>
      </div>

      <!-- Bill Section -->
      <div>
        <div class="bg-white rounded-lg bill-card p-4 sticky top-4">
          <h2 class="text-xl font-bold text-green-800 mb-4 border-b pb-2">‡¥¨‡¥ø‡µΩ</h2>
          <div class="space-y-3 mb-4 max-h-64 overflow-y-auto">
            <div v-for="(item, id) in cartItems" :key="id" class="flex justify-between border-b pb-2">
              <div>
                <span class="block">{{ item.name }}</span>
                <span class="text-sm text-gray-500">{{ item.quantity }} ‡¥ï‡¥ø‡¥≤‡µã √ó ‚Çπ{{ item.price.toFixed(2) }}</span>
              </div>
              <span class="font-medium">‚Çπ{{ (item.price * item.quantity).toFixed(2) }}</span>
            </div>
            <div v-if="cartItems.length === 0" class="text-center py-4 text-gray-500">
              ‡¥á‡¥§‡µÅ‡¥µ‡¥∞‡µÜ ‡¥í‡¥®‡µç‡¥®‡µÅ‡¥Ç ‡¥§‡¥ø‡¥∞‡¥û‡µç‡¥û‡µÜ‡¥ü‡µÅ‡¥§‡µç‡¥§‡¥ø‡¥ü‡µç‡¥ü‡¥ø‡¥≤‡µç‡¥≤
            </div>
          </div>
          
          <div class="border-t pt-3 space-y-2">
            <div class="flex justify-between">
              <span>‡¥Ü‡¥ï‡µÜ ‡¥§‡µÅ‡¥ï</span>
              <span>‚Çπ{{ subtotal.toFixed(2) }}</span>
            </div>
            <div v-if="discount > 0" class="flex justify-between text-green-600">
              <span>‡¥°‡¥ø‡¥∏‡µç‡¥ï‡µó‡¥£‡µç‡¥ü‡µç (5%)</span>
              <span>-‚Çπ{{ discount.toFixed(2) }}</span>
            </div>
            <div class="flex justify-between">
              <span>‡¥ú‡¥ø‡¥é‡¥∏‡µç‡¥ü‡¥ø (5%)</span>
              <span>‚Çπ{{ tax.toFixed(2) }}</span>
            </div>
            <div class="flex justify-between font-bold text-lg border-t pt-2 mt-2">
              <span>‡¥Æ‡µä‡¥§‡µç‡¥§‡¥Ç ‡¥§‡µÅ‡¥ï</span>
              <span>‚Çπ{{ total.toFixed(2) }}</span>
            </div>
          </div>
          
          <button 
            @click="generateBill"
            :disabled="cartItems.length === 0"
            class="w-full bg-green-600 hover:bg-green-700 text-white py-3 rounded-lg font-bold mt-6 disabled:bg-gray-400"
          >
            ‡¥¨‡¥ø‡µΩ ‡¥™‡µç‡¥∞‡¥ø‡¥®‡µç‡¥±‡µç ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡µÅ‡¥ï
          </button>
        </div>
      </div>
    </div>

    <!-- Bill Preview Modal -->
    <div v-if="showBillPreview" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
      <div class="bg-white rounded-lg w-full max-w-md p-6 max-h-[90vh] overflow-y-auto">
        <div class="text-center mb-4">
          <h2 class="text-2xl font-bold text-green-700">{{ shop.name }}</h2>
          <p class="text-gray-600">{{ shop.location }}</p>
          <p class="text-gray-600 mt-2">‡¥¨‡¥ø‡µΩ ‡¥®‡¥Æ‡µç‡¥™‡µº: {{ billNumber }}</p>
          <p class="text-gray-600">‡¥§‡µÄ‡¥Ø‡¥§‡¥ø: {{ new Date().toLocaleDateString() }}</p>
        </div>
        
        <div class="border-t border-b py-2 my-3">
          <div v-if="customer.name" class="flex justify-between">
            <span class="font-medium">‡¥™‡µá‡¥∞‡µç:</span>
            <span>{{ customer.name }}</span>
          </div>
          <div v-if="customer.phone" class="flex justify-between">
            <span class="font-medium">‡¥´‡µã‡µ∫:</span>
            <span>{{ customer.phone }}</span>
          </div>
        </div>
        
        <div class="mb-4">
          <div v-for="(item, index) in cartItems" :key="index" class="flex justify-between py-1">
            <span>{{ item.name }} ({{ item.quantity }} ‡¥ï‡¥ø‡¥≤‡µã)</span>
            <span>‚Çπ{{ (item.price * item.quantity).toFixed(2) }}</span>
          </div>
        </div>
        
        <div class="border-t pt-2 space-y-1">
          <div class="flex justify-between">
            <span>‡¥Ü‡¥ï‡µÜ ‡¥§‡µÅ‡¥ï:</span>
            <span>‚Çπ{{ subtotal.toFixed(2) }}</span>
          </div>
          <div v-if="discount > 0" class="flex justify-between text-green-600">
            <span>‡¥°‡¥ø‡¥∏‡µç‡¥ï‡µó‡¥£‡µç‡¥ü‡µç:</span>
            <span>-‚Çπ{{ discount.toFixed(2) }}</span>
          </div>
          <div class="flex justify-between">
            <span>‡¥ú‡¥ø‡¥é‡¥∏‡µç‡¥ü‡¥ø (5%):</span>
            <span>‚Çπ{{ tax.toFixed(2) }}</span>
          </div>
          <div class="flex justify-between font-bold text-lg border-t pt-2 mt-2">
            <span>‡¥Æ‡µä‡¥§‡µç‡¥§‡¥Ç ‡¥§‡µÅ‡¥ï:</span>
            <span>‚Çπ{{ total.toFixed(2) }}</span>
          </div>
        </div>
        
        <div class="mt-6 text-center text-sm text-gray-500">
          <p>‡¥®‡¥®‡µç‡¥¶‡¥ø! ‡¥µ‡µÄ‡¥£‡µç‡¥ü‡µÅ‡¥Ç ‡¥µ‡¥∞‡µÅ‡¥ï</p>
          <p class="mt-1">‡¥´‡µã‡µ∫: {{ shop.phone }}</p>
        </div>
        
        <div class="mt-6 flex justify-center">
          <button 
            @click="printBill"
            class="bg-blue-600 text-white px-4 py-2 rounded mr-2"
          >
            <i class="fas fa-print mr-1"></i> ‡¥™‡µç‡¥∞‡¥ø‡¥®‡µç‡¥±‡µç
          </button>
          <button 
            @click="closeBillPreview"
            class="bg-gray-600 text-white px-4 py-2 rounded"
          >
            ‡¥Ö‡¥ü‡¥Ø‡µç‡¥ï‡µç‡¥ï‡µÅ‡¥ï
          </button>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
import { ref, reactive, computed, onMounted } from 'vue'
import ShopService from '../services/ShopService'
import { useAuthStore } from '@/stores/auth'

export default {
  setup() {
    const authStore = useAuthStore()
    
    // Shop data
    const shop = ref({
      name: '‡¥π‡¥∞‡¥ø‡¥§ ‡¥™‡¥ö‡µç‡¥ö‡¥ï‡µç‡¥ï‡¥±‡¥ø ‡¥ï‡¥ü',
      location: '‡¥§‡µÉ‡¥∂‡µÇ‡µº, ‡¥ï‡µá‡¥∞‡¥≥‡¥Ç',
      phone: '9895123456',
      current_offer: '500 ‡¥∞‡µÇ‡¥™‡¥Ø‡µç‡¥ï‡µç‡¥ï‡µç ‡¥Æ‡µÅ‡¥ï‡¥≥‡¥ø‡µΩ ‡¥µ‡¥æ‡¥ô‡µç‡¥ô‡¥ø‡¥Ø‡¥æ‡µΩ 5% ‡¥°‡¥ø‡¥∏‡µç‡¥ï‡µó‡¥£‡µç‡¥ü‡µç!'
    })

    // Product data
    const loading = ref(false)
    const products = ref([
      { id: 1, name: '‡¥§‡¥ï‡µç‡¥ï‡¥æ‡¥≥‡¥ø', price: 30 },
      { id: 2, name: '‡¥µ‡¥¥‡µÅ‡¥§‡¥®', price: 25 },
      { id: 3, name: '‡¥ï‡¥æ‡¥∞‡¥±‡µç‡¥±‡µç', price: 40 },
      { id: 4, name: '‡¥â‡¥≥‡µç‡¥≥‡¥ø', price: 20 },
      { id: 5, name: '‡¥™‡¥ö‡µç‡¥ö‡¥Æ‡µÅ‡¥≥‡¥ï‡µç', price: 60 },
      { id: 6, name: '‡¥ï‡µÅ‡¥ï‡µç‡¥ï‡µÅ‡¥Æ‡µç‡¥™‡µº', price: 15 }
    ])

    // Quantities management
    const quantities = reactive({})
    products.value.forEach(product => {
      quantities[product.id] = 0
    })

    // Customer details
    const customer = reactive({
      name: '',
      phone: '',
      address: ''
    })

    // Bill state
    const showBillPreview = ref(false)
    const billNumber = ref(Math.floor(1000 + Math.random() * 9000))

    // Computed properties
    const cartItems = computed(() => 
      products.value.filter(p => quantities[p.id] > 0)
    )

    const subtotal = computed(() => 
      cartItems.value.reduce((sum, item) => sum + (quantities[item.id] * item.price), 0)
    )

    const discount = computed(() => 
      subtotal.value > 500 ? subtotal.value * 0.05 : 0
    )

    const taxableAmount = computed(() => 
      subtotal.value - discount.value
    )

    const tax = computed(() => 
      taxableAmount.value * 0.05
    )

    const total = computed(() => 
      taxableAmount.value + tax.value
    )

    // Methods
    const getProductQuantity = (productId) => {
      return quantities[productId] || 0
    }

    const updateQuantity = (productId, newQuantity) => {
      quantities[productId] = Math.max(0, parseFloat(newQuantity) || 0)
    }

    const incrementQuantity = (productId) => {
      quantities[productId] = (quantities[productId] || 0) + 1
    }

    const decrementQuantity = (productId) => {
      quantities[productId] = Math.max(0, (quantities[productId] || 0) - 1)
    }

    const generateBill = () => {
      if (cartItems.value.length === 0) return
      
      showBillPreview.value = true
      billNumber.value = Math.floor(1000 + Math.random() * 9000)
    }

    const printBill = () => {
      window.print()
    }

    const closeBillPreview = () => {
      showBillPreview.value = false
    }

    // Lifecycle hooks
    onMounted(async () => {
      try {
        // Get shop ID from authenticated user or route params
        const shopId = authStore.user?.shop_id || 1 // Default to 1 if not available
        const shopData = await ShopService.getShopDetails(shopId)
        shop.value = {
          ...shop.value,
          ...shopData
        }
      } catch (error) {
        console.error('Error loading shop data:', error)
      }
    })

    return {
      shop,
      loading,
      products,
      quantities,
      customer,
      cartItems,
      subtotal,
      discount,
      tax,
      total,
      showBillPreview,
      billNumber,
      getProductQuantity,
      updateQuantity,
      incrementQuantity,
      decrementQuantity,
      generateBill,
      printBill,
      closeBillPreview
    }
  }
}
</script>

<style scoped>
.bill-card {
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

@media print {
  body * {
    visibility: hidden;
  }
  #bill-preview, #bill-preview * {
    visibility: visible;
  }
  #bill-preview {
    position: absolute;
    left: 0;
    top: 0;
    width: 100%;
    max-width: 100%;
  }
  .no-print {
    display: none !important;
  }
}
</style> , 2)<!-- src/components/billing/ProductItem.vue -->
<template>
    <div class="product-card bg-white border rounded-lg p-4">
      <div class="flex items-start">
        <img :src="product.image" :alt="product.name" class="w-16 h-16 object-cover rounded">
        <div class="ml-3 flex-1">
          <h3 class="font-bold text-gray-800">{{ product.name }}</h3>
          <p class="text-sm text-gray-600">{{ product.description }}</p>
          <p class="text-green-700 font-bold mt-1">‚Çπ{{ product.price }} / ‡¥ï‡¥ø‡¥≤‡µã</p>
        </div>
      </div>
      
      <div class="mt-3 flex items-center justify-between">
        <div class="flex items-center border rounded">
          <!-- Decrement Controls -->
          <div class="relative">
            <button 
              @mousedown.prevent="startLongPress('decrement')"
              @mouseup="clearLongPress"
              @touchstart.prevent="startLongPress('decrement')"
              @touchend="clearLongPress"
              class="quantity-btn px-3 py-1 bg-gray-100"
            >
              -
            </button>
            <div v-show="showDecrementMenu" class="absolute bg-white border rounded mt-1 z-10 shadow-lg">
              <button 
                v-for="option in fractionOptions" 
                :key="option.label"
                @click="updateQuantity(option.value)"
                class="block w-full px-3 py-1 hover:bg-gray-100 text-sm"
              >
                {{ option.decrementLabel }}
              </button>
            </div>
          </div>
  
          <!-- Quantity Display -->
          <div class="flex items-center">
            <span class="px-3">{{ product.quantity.toFixed(2) }}</span>
            <button 
              @click="$emit('clear-quantity', product.id)"
              class="clear-btn px-2 text-red-600 hover:text-red-800"
              title="Clear quantity"
            >
              √ó
            </button>
          </div>
  
          <!-- Increment Controls -->
          <div class="relative">
            <button 
              @mousedown.prevent="startLongPress('increment')"
              @mouseup="clearLongPress"
              @touchstart.prevent="startLongPress('increment')"
              @touchend="clearLongPress"
              class="quantity-btn px-3 py-1 bg-gray-100"
            >
              +
            </button>
            <div v-show="showIncrementMenu" class="absolute bg-white border rounded mt-1 z-10 shadow-lg">
              <button 
                v-for="option in fractionOptions" 
                :key="option.label"
                @click="updateQuantity(option.value)"
                class="block w-full px-3 py-1 hover:bg-gray-100 text-sm"
              >
                {{ option.incrementLabel }}
              </button>
            </div>
          </div>
        </div>
        
        <span class="font-bold">‚Çπ{{ (product.quantity * product.price).toFixed(2) }}</span>
      </div>
    </div>
  </template>
  
  <script setup>
  import { ref } from 'vue'
  
  const props = defineProps({
    product: {
      type: Object,
      required: true
    }
  })
  
  const emit = defineEmits(['update-quantity', 'clear-quantity'])
  
  const fractionOptions = [
    { value: 2, label: '2', decrementLabel: '-2', incrementLabel: '+2' },
    { value: 0.75, label: '¬æ', decrementLabel: '-¬æ ‡¥Æ‡µÅ‡¥ï‡µç‡¥ï‡¥æ‡µΩ', incrementLabel: '+¬æ ‡¥Æ‡µÅ‡¥ï‡µç‡¥ï‡¥æ‡µΩ' },
    { value: 0.5, label: '¬Ω', decrementLabel: '-¬Ω ‡¥Ö‡¥∞', incrementLabel: '+¬Ω ‡¥Ö‡¥∞' },
    { value: 0.25, label: '¬º', decrementLabel: '-¬º ‡¥ï‡¥æ‡µΩ', incrementLabel: '+¬º ‡¥ï‡¥æ‡µΩ' }
  ]
  
  const showIncrementMenu = ref(false)
  const showDecrementMenu = ref(false)
  let longPressTimer = null
  
  const startLongPress = (type) => {
    longPressTimer = setTimeout(() => {
      type === 'increment' 
        ? showIncrementMenu.value = true
        : showDecrementMenu.value = true
    }, 500)
  }
  
  const clearLongPress = () => {
    clearTimeout(longPressTimer)
    showIncrementMenu.value = false
    showDecrementMenu.value = false
  }
  
  const updateQuantity = (change) => {
  const newQuantity = Math.max(0, parseFloat((props.product.quantity + change).toFixed(2)),
  emit('update-quantity', props.product.id, newQuantity),
  showIncrementMenu.value = false,
  showDecrementMenu.value = false)
}
  </script>
  
  <style scoped>
  .quantity-btn {
    transition: all 0.2s;
    min-width: 2.5rem;
  }
  
  .clear-btn {
    border-left: 1px solid #e5e7eb;
    border-right: 1px solid #e5e7eb;
    transition: color 0.2s;
  }
  </style>,  3)<!-- src/components/billing/BillPreview.vue -->
<template>
    <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
      <div class="bg-white rounded-lg p-6 max-w-md w-full mx-4">
        <div class="text-center mb-4">
          <h3 class="text-lg font-bold">‡¥π‡¥∞‡¥ø‡¥§ ‡¥™‡¥ö‡µç‡¥ö‡¥ï‡µç‡¥ï‡¥±‡¥ø ‡¥ï‡¥ü</h3>
          <p class="text-xs text-gray-600">‡¥§‡µÉ‡¥∂‡µÇ‡µº, ‡¥ï‡µá‡¥∞‡¥≥‡¥Ç</p>
        </div>
        
        <!-- Customer Details -->
        <div class="text-xs mb-4">
          <p>‡¥â‡¥™‡¥≠‡µã‡¥ï‡µç‡¥§‡¥æ‡¥µ‡µç: {{ customer.name || "‡¥ï‡µç‡¥≤‡¥Ø‡¥®‡µç‡¥±‡µç" }}</p>
          <p>‡¥´‡µã‡µ∫: {{ customer.phone || "N/A" }}</p>
          <p>‡¥§‡µÄ‡¥Ø‡¥§‡¥ø: {{ currentDate }}</p>
        </div>
  
        <!-- Bill Items -->
        <table class="w-full text-xs mb-2">
          <thead>
            <tr class="border-b">
              <th class="text-left py-1">‡¥™‡¥ö‡µç‡¥ö‡¥ï‡µç‡¥ï‡¥±‡¥ø</th>
              <th class="text-right py-1">‡¥Ö‡¥≥‡¥µ‡µç</th>
              <th class="text-right py-1">‡¥§‡µÅ‡¥ï</th>
            </tr>
          </thead>
          <tbody>
            <tr v-for="item in cartItems" :key="item.id">
              <td class="py-1">{{ item.name }}</td>
              <td class="text-right py-1">{{ item.quantity.toFixed(2) }} ‡¥ï‡¥ø‡¥≤‡µã</td>
              <td class="text-right py-1">‚Çπ{{ (item.quantity * item.price).toFixed(2) }}</td>
            </tr>
          </tbody>
        </table>
  
        <!-- Totals -->
        <table class="w-full text-xs">
        <tbody>
            <tr class="border-t">
            <td class="py-1">‡¥Ü‡¥ï‡µÜ ‡¥§‡µÅ‡¥ï</td>
            <td class="text-right py-1">‚Çπ{{ subtotal.toFixed(2) }}</td>
            </tr>
            <tr>
            <td class="py-1">‡¥°‡¥ø‡¥∏‡µç‡¥ï‡µó‡¥£‡µç‡¥ü‡µç (5%)</td>
            <td class="text-right py-1">‚Çπ{{ discount.toFixed(2) }}</td>
            </tr>
            <tr>
            <td class="py-1">‡¥ú‡¥ø‡¥é‡¥∏‡µç‡¥ü‡¥ø (5%)</td>
            <td class="text-right py-1">‚Çπ{{ tax.toFixed(2) }}</td>
            </tr>
            <tr class="border-t font-bold">
            <td class="py-1">‡¥Æ‡µä‡¥§‡µç‡¥§‡¥Ç ‡¥§‡µÅ‡¥ï</td>
            <td class="text-right py-1">‚Çπ{{ total.toFixed(2) }}</td>
            </tr>
        </tbody>
        </table>
  
        <div class="text-center text-xs mt-4">
          <p>‡¥®‡¥®‡µç‡¥¶‡¥ø! ‡¥µ‡µÄ‡¥£‡µç‡¥ü‡µÅ‡¥Ç ‡¥µ‡¥∞‡µÇ!</p>
        </div>
  
        <!-- Actions -->
        <div class="mt-6 flex gap-4">
          <button 
            @click="printBill"
            class="flex-1 bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-lg font-bold"
          >
            <i class="fas fa-print mr-2"></i> ‡¥™‡µç‡¥∞‡¥ø‡¥®‡µç‡¥±‡µç
          </button>
          <button 
            @click="$emit('close')"
            class="flex-1 bg-gray-600 hover:bg-gray-700 text-white py-2 rounded-lg font-bold"
          >
            ‡¥Ö‡¥ü‡¥Ø‡µç‡¥ï‡µç‡¥ï‡µÅ‡¥ï
          </button>
        </div>
      </div>
    </div>
  </template>
  
  <script setup>
  import { computed } from 'vue'
  
  const props = defineProps({
    customer: Object,
    cartItems: Array,
    subtotal: Number,
    discount: Number,
    tax: Number,
    total: Number
  })
  
  const emit = defineEmits(['close'])
  
  const currentDate = computed(() => 
    new Date().toLocaleDateString('ml-IN', {
      year: 'numeric',
      month: 'long',
      day: 'numeric'
    })
  )
  
  const printBill = () => {
    const printContent = `
    <div class="bill-print-content">
      <div class="text-center mb-4">
        <h3 class="text-lg font-bold">‡¥π‡¥∞‡¥ø‡¥§ ‡¥™‡¥ö‡µç‡¥ö‡¥ï‡µç‡¥ï‡¥±‡¥ø ‡¥ï‡¥ü</h3>
        <p class="text-xs text-gray-600">‡¥§‡µÉ‡¥∂‡µÇ‡µº, ‡¥ï‡µá‡¥∞‡¥≥‡¥Ç</p>
      </div>
      
      <!-- Add rest of the bill content using props -->
      <div class="text-xs mb-4">
        <p>‡¥â‡¥™‡¥≠‡µã‡¥ï‡µç‡¥§‡¥æ‡¥µ‡µç: ${props.customer.name || "‡¥ï‡µç‡¥≤‡¥Ø‡¥®‡µç‡¥±‡µç"}</p>
        <p>‡¥´‡µã‡µ∫: ${props.customer.phone || "N/A"}</p>
        <p>‡¥§‡µÄ‡¥Ø‡¥§‡¥ø: ${currentDate.value}</p>
      </div>

      <!-- Add all other bill sections using props data -->
      
    </div>
  `
  
  const printWindow = window.open('', '_blank')
  printWindow.document.write(`
    <html>
      <head>
        <title>Bill Print</title>
        <script src="https://cdn.tailwindcss.com"><\/script>
        <style>
          @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+Malayalam:wght@400;500;700&display=swap');
          body { font-family: 'Noto Sans Malayalam', sans-serif; }
        </style>
      </head>
      <body>
        ${printContent}
      </body>
    </html>
  `)
  printWindow.document.close()
  printWindow.print()
  }
  </script>
  
  <style scoped>
  .bill-print-content {
    width: 80mm;
    margin: 0 auto;
    padding: 10px;
    font-family: 'Noto Sans Malayalam', sans-serif;
  }
  </style>  ) , here i will provide my front-end auth service -> // front-end/src/services/auth.js
import { apiFetch } from '@/utils/api';
import { useAuthStore } from '@/stores/auth';
export default {
  async login(email, password, remember) {
    try {
      const API_BASE = import.meta.env.VITE_API_URL || 'http://localhost:3000/api/v1';
      const response = await fetch(`${API_BASE}/auth/login`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ email, password })
      });
      const text = await response.text();
      const data = text ? JSON.parse(text) : {};
      if (!response.ok) {
        throw new Error(data.message || 'Login failed');
      }
      return data;
    } catch (error) {
      console.error('Auth login error:', error);
      throw new Error(error.message || 'Unexpected login error');
    }
  },
  async logout() {
    const authStore = useAuthStore();
    await apiFetch('/v1/auth/logout', { method: 'POST' });
    authStore.clearAuth();  // Use store's method instead of `this`
  },
  async refreshToken() {
    const authStore = useAuthStore();
    try {
      const data = await apiFetch('/v1/auth/refresh');
      authStore.token = data.token;
      return true;
    } catch (error) {
      authStore.clearAuth();
      return false;
    }
  }
};
, and my database logic -> 
* **`permission_type` (ENUM):** A custom enumeration defining the different types of permissions that can be assigned to users within shops (e.g., `view_dashboard`, `manage_inventory`).
* **`users`:** Stores user information, including name, email (unique), password hash, phone, optional license file, terms acceptance, and a global user role (`owner`, `employee`, `customer`). Importantly, this table does not directly link to shops.
* **`shops`:** Stores information about individual store locations, including name, location, contact details, status (`active`, `inactive`, `needs-update`), and a foreign key `owner_id` referencing the `users` table to identify the shop owner.
* **`products`:** Stores general product information that is consistent across all shops, such as name, description, active status, SKU (unique), barcode (unique), category, brand, unit, and unit value. This table is shop-agnostic.
* **`shop_products`:** A junction table establishing a many-to-many relationship between `shops` and `products`. It stores shop-specific details like `retail_price`, `wholesale_price`, `purchase_price`, and `stock` levels. The combination of `shop_id` and `product_id` is unique.
* **`employee_profiles`:** Stores additional information specific to employees, linking a `user_id` (from the `users` table) to a `managed_by` user (their manager) and an `is_active` status.
* **`shop_permissions`:** Defines the specific permissions a user has within a particular shop. It links `user_id` and `shop_id` and uses the `permission_type` ENUM as an array to store the granted permissions for a specific `role` (e.g., `manager`, `cashier`). The combination of `user_id` and `shop_id` is unique.
* **`price_history`:** Tracks changes to product prices. It records the `product_id`, the optional `shop_id` (for shop-specific changes), the `price_type` (`retail`, `wholesale`, `purchase`), the `old_price`, the `new_price`, and the `changed_by` user (referencing the `users` table).
* **`promotions`:** Stores information about promotional offers available in specific shops, including the `shop_id`, offer text, start and end dates, minimum purchase amount, and discount percentage. , create backend node controller , routes , for hadling this billing process , also here i will provide my knex file -> import 'dotenv/config'; // Ensure dotenv is imported
export default {
  development: {
    client: 'pg',
    connection: {
      host: process.env.DB_HOST,
      port: process.env.DB_PORT,
      user: process.env.DB_USER,
      password: String(process.env.DB_PASSWORD), // Explicit string conversion
      database: process.env.DB_NAME,
    },
    migrations: {
      directory: './db/migrations',
      loadExtensions: ['.js'] // Important for ES modules
    },
    seeds: {
      directory: './db/seeds'
    }
  }
};
,  this is for you for depeloping the proper functionality that  product quantity increment and decrement functionality , if product with quantity is billed then the respective product with that quantity stock should be removed form the corresponding and currently it is loading with hardcoded datas but i need fully functional with the backend database connectivity so create it , also i will provide my frontend-route=>   {
    path: '/billing',
    name: 'Billing',
    component: BillingView,
    meta: { requiresAuth: true, title: 'Billing - ‡¥™‡¥ö‡µç‡¥ö‡¥ï‡µç‡¥ï‡¥±‡¥ø ‡¥ï‡¥ü' }
  }, but when login we stored shop_id in user object , and token with the help of penia 

</div>



<div>
  consider this " // In setup() function
  const authStore = useAuthStore();
  const loading = ref(true);
  const products = ref(\[]);
  
  // Fetch products from backend
  const fetchProducts = async () => {
  try {
  loading.value = true;
  const response = await apiFetch('/billing/products');
  products.value = response.products.map(p => ({
  ...p,
  price: parseFloat(p.price),
  stock: parseFloat(p.stock)
  }));
  } catch (error) {
  console.error('Error loading products:', error);
  } finally {
  loading.value = false;
  }
  };
  
  // Update generateBill function
  const generateBill = async () => {
  try {
  const items = cartItems.value.map(item => ({
  product\_id: item.id,
  quantity: item.quantity
  }));
  
  ```
  await apiFetch('/billing/process-sale', {
    method: 'POST',
    body: { items }
  });
  
  // Show preview and reset form
  showBillPreview.value = true;
  billNumber.value = Math.floor(1000 + Math.random() * 9000);
  resetForm();
  ```
  
  } catch (error) {
  console.error('Error processing sale:', error);
  alert(`Error: ${error.message}`);
  }
  };
  
  // Add stock validation
  const incrementQuantity = (productId) => {
  const product = products.value.find(p => p.id === productId);
  if (product && quantities\[productId] < product.stock) {
  quantities\[productId]++;
  }
  };
  
  const updateQuantity = (productId, newQuantity) => {
  const product = products.value.find(p => p.id === productId);
  const maxQty = product ? product.stock : 0;
  quantities\[productId] = Math.min(Math.max(0, newQuantity), maxQty);
  };
  
  // Initialize quantities with product IDs
  onMounted(async () => {
  await fetchProducts();
  products.value.forEach(product => {
  quantities\[product.id] = 0;
  });
  });" with this Update following BillingView\.vue and recreate the full file here, check the BillingView\.vue-><!-- front-end/src/views/BillingView.vue--> <template>
  
    <div class="container mx-auto px-4 py-8">
      <!-- Header -->
      <header class="mb-8 text-center">
        <h1 class="text-3xl font-bold text-green-700">{{ shop.name }}</h1>
        <p class="text-gray-600">{{ shop.location }} | ‡¥´‡µã‡µ∫: {{ shop.phone }}</p>
        <div v-if="shop.current_offer" class="mt-4 bg-green-100 p-3 rounded-lg">
          <p class="text-green-800 font-medium">‡¥á‡¥®‡µç‡¥®‡¥§‡µç‡¥§‡µÜ ‡¥ì‡¥´‡µº: {{ shop.current_offer }}</p>
        </div>
      </header>
  
  ```
  <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
    <!-- Products Section -->
    <div class="lg:col-span-2">
      <div class="bg-white rounded-lg bill-card p-4 mb-6">
        <h2 class="text-xl font-bold text-green-800 mb-4 border-b pb-2">‡¥™‡¥ö‡µç‡¥ö‡¥ï‡µç‡¥ï‡¥±‡¥ø‡¥ï‡µæ</h2>
        <div v-if="loading" class="text-center py-8">
          <i class="fas fa-spinner fa-spin text-2xl text-blue-500"></i>
          <p class="mt-2">Loading products...</p>
        </div>
        <div v-else class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div v-for="product in products" :key="product.id" class="border rounded-lg p-3">
            <div class="flex justify-between items-start">
              <div>
                <h3 class="font-bold text-gray-800">{{ product.name }}</h3>
                <p class="text-sm text-gray-600">‚Çπ{{ product.price.toFixed(2) }} / ‡¥ï‡¥ø‡¥≤‡µã</p>
              </div>
              <div class="flex items-center">
                <button 
                  @click="decrementQuantity(product.id)"
                  class="w-8 h-8 bg-gray-200 rounded flex items-center justify-center"
                  :disabled="getProductQuantity(product.id) <= 0"
                >
                  <i class="fas fa-minus"></i>
                </button>
                <input 
                  type="number" 
                  v-model.number="quantities[product.id]"
                  @change="updateQuantity(product.id, quantities[product.id])"
                  min="0"
                  step="0.1"
                  class="w-16 mx-2 text-center border rounded"
                />
                <button 
                  @click="incrementQuantity(product.id)"
                  class="w-8 h-8 bg-green-200 rounded flex items-center justify-center"
                >
                  <i class="fas fa-plus"></i>
                </button>
              </div>
            </div>
            <div class="mt-2 flex justify-between">
              <span class="text-sm text-gray-500">‡¥Æ‡µä‡¥§‡µç‡¥§‡¥Ç: </span>
              <span class="font-medium">‚Çπ{{ (getProductQuantity(product.id) * product.price).toFixed(2) }}</span>
            </div>
          </div>
        </div>
      </div>
  
      <!-- Customer Details -->
      <div class="bg-white rounded-lg bill-card p-4">
        <h2 class="text-xl font-bold text-green-800 mb-4 border-b pb-2">‡¥â‡¥™‡¥≠‡µã‡¥ï‡µç‡¥§‡µÉ ‡¥µ‡¥ø‡¥µ‡¥∞‡¥ô‡µç‡¥ô‡µæ</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label class="block text-gray-700 mb-1">‡¥™‡µá‡¥∞‡µç</label>
            <input v-model="customer.name" type="text" class="w-full border rounded px-3 py-2">
          </div>
          <div>
            <label class="block text-gray-700 mb-1">‡¥´‡µã‡µ∫ ‡¥®‡¥Æ‡µç‡¥™‡µº</label>
            <input v-model="customer.phone" type="text" class="w-full border rounded px-3 py-2">
          </div>
          <div class="md:col-span-2">
            <label class="block text-gray-700 mb-1">‡¥µ‡¥ø‡¥≤‡¥æ‡¥∏‡¥Ç</label>
            <textarea v-model="customer.address" class="w-full border rounded px-3 py-2" rows="2"></textarea>
          </div>
        </div>
      </div>
    </div>
  
    <!-- Bill Section -->
    <div>
      <div class="bg-white rounded-lg bill-card p-4 sticky top-4">
        <h2 class="text-xl font-bold text-green-800 mb-4 border-b pb-2">‡¥¨‡¥ø‡µΩ</h2>
        <div class="space-y-3 mb-4 max-h-64 overflow-y-auto">
          <div v-for="(item, id) in cartItems" :key="id" class="flex justify-between border-b pb-2">
            <div>
              <span class="block">{{ item.name }}</span>
              <span class="text-sm text-gray-500">{{ item.quantity }} ‡¥ï‡¥ø‡¥≤‡µã √ó ‚Çπ{{ item.price.toFixed(2) }}</span>
            </div>
            <span class="font-medium">‚Çπ{{ (item.price * item.quantity).toFixed(2) }}</span>
          </div>
          <div v-if="cartItems.length === 0" class="text-center py-4 text-gray-500">
            ‡¥á‡¥§‡µÅ‡¥µ‡¥∞‡µÜ ‡¥í‡¥®‡µç‡¥®‡µÅ‡¥Ç ‡¥§‡¥ø‡¥∞‡¥û‡µç‡¥û‡µÜ‡¥ü‡µÅ‡¥§‡µç‡¥§‡¥ø‡¥ü‡µç‡¥ü‡¥ø‡¥≤‡µç‡¥≤
          </div>
        </div>
        
        <div class="border-t pt-3 space-y-2">
          <div class="flex justify-between">
            <span>‡¥Ü‡¥ï‡µÜ ‡¥§‡µÅ‡¥ï</span>
            <span>‚Çπ{{ subtotal.toFixed(2) }}</span>
          </div>
          <div v-if="discount > 0" class="flex justify-between text-green-600">
            <span>‡¥°‡¥ø‡¥∏‡µç‡¥ï‡µó‡¥£‡µç‡¥ü‡µç (5%)</span>
            <span>-‚Çπ{{ discount.toFixed(2) }}</span>
          </div>
          <div class="flex justify-between">
            <span>‡¥ú‡¥ø‡¥é‡¥∏‡µç‡¥ü‡¥ø (5%)</span>
            <span>‚Çπ{{ tax.toFixed(2) }}</span>
          </div>
          <div class="flex justify-between font-bold text-lg border-t pt-2 mt-2">
            <span>‡¥Æ‡µä‡¥§‡µç‡¥§‡¥Ç ‡¥§‡µÅ‡¥ï</span>
            <span>‚Çπ{{ total.toFixed(2) }}</span>
          </div>
        </div>
        
        <button 
          @click="generateBill"
          :disabled="cartItems.length === 0"
          class="w-full bg-green-600 hover:bg-green-700 text-white py-3 rounded-lg font-bold mt-6 disabled:bg-gray-400"
        >
          ‡¥¨‡¥ø‡µΩ ‡¥™‡µç‡¥∞‡¥ø‡¥®‡µç‡¥±‡µç ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡µÅ‡¥ï
        </button>
      </div>
    </div>
  </div>
  
  <!-- Bill Preview Modal -->
  <div v-if="showBillPreview" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
    <div class="bg-white rounded-lg w-full max-w-md p-6 max-h-[90vh] overflow-y-auto">
      <div class="text-center mb-4">
        <h2 class="text-2xl font-bold text-green-700">{{ shop.name }}</h2>
        <p class="text-gray-600">{{ shop.location }}</p>
        <p class="text-gray-600 mt-2">‡¥¨‡¥ø‡µΩ ‡¥®‡¥Æ‡µç‡¥™‡µº: {{ billNumber }}</p>
        <p class="text-gray-600">‡¥§‡µÄ‡¥Ø‡¥§‡¥ø: {{ new Date().toLocaleDateString() }}</p>
      </div>
      
      <div class="border-t border-b py-2 my-3">
        <div v-if="customer.name" class="flex justify-between">
          <span class="font-medium">‡¥™‡µá‡¥∞‡µç:</span>
          <span>{{ customer.name }}</span>
        </div>
        <div v-if="customer.phone" class="flex justify-between">
          <span class="font-medium">‡¥´‡µã‡µ∫:</span>
          <span>{{ customer.phone }}</span>
        </div>
      </div>
      
      <div class="mb-4">
        <div v-for="(item, index) in cartItems" :key="index" class="flex justify-between py-1">
          <span>{{ item.name }} ({{ item.quantity }} ‡¥ï‡¥ø‡¥≤‡µã)</span>
          <span>‚Çπ{{ (item.price * item.quantity).toFixed(2) }}</span>
        </div>
      </div>
      
      <div class="border-t pt-2 space-y-1">
        <div class="flex justify-between">
          <span>‡¥Ü‡¥ï‡µÜ ‡¥§‡µÅ‡¥ï:</span>
          <span>‚Çπ{{ subtotal.toFixed(2) }}</span>
        </div>
        <div v-if="discount > 0" class="flex justify-between text-green-600">
          <span>‡¥°‡¥ø‡¥∏‡µç‡¥ï‡µó‡¥£‡µç‡¥ü‡µç:</span>
          <span>-‚Çπ{{ discount.toFixed(2) }}</span>
        </div>
        <div class="flex justify-between">
          <span>‡¥ú‡¥ø‡¥é‡¥∏‡µç‡¥ü‡¥ø (5%):</span>
          <span>‚Çπ{{ tax.toFixed(2) }}</span>
        </div>
        <div class="flex justify-between font-bold text-lg border-t pt-2 mt-2">
          <span>‡¥Æ‡µä‡¥§‡µç‡¥§‡¥Ç ‡¥§‡µÅ‡¥ï:</span>
          <span>‚Çπ{{ total.toFixed(2) }}</span>
        </div>
      </div>
      
      <div class="mt-6 text-center text-sm text-gray-500">
        <p>‡¥®‡¥®‡µç‡¥¶‡¥ø! ‡¥µ‡µÄ‡¥£‡µç‡¥ü‡µÅ‡¥Ç ‡¥µ‡¥∞‡µÅ‡¥ï</p>
        <p class="mt-1">‡¥´‡µã‡µ∫: {{ shop.phone }}</p>
      </div>
      
      <div class="mt-6 flex justify-center">
        <button 
          @click="printBill"
          class="bg-blue-600 text-white px-4 py-2 rounded mr-2"
        >
          <i class="fas fa-print mr-1"></i> ‡¥™‡µç‡¥∞‡¥ø‡¥®‡µç‡¥±‡µç
        </button>
        <button 
          @click="closeBillPreview"
          class="bg-gray-600 text-white px-4 py-2 rounded"
        >
          ‡¥Ö‡¥ü‡¥Ø‡µç‡¥ï‡µç‡¥ï‡µÅ‡¥ï
        </button>
      </div>
    </div>
  </div>
  ```
  
    </div>
  </template>
  
  <script>
  import { ref, reactive, computed, onMounted } from 'vue'
  import ShopService from '../services/ShopService'
  import { useAuthStore } from '@/stores/auth'
  
  export default {
    setup() {
      const authStore = useAuthStore()
      
      // Shop data
      const shop = ref({
        name: '‡¥π‡¥∞‡¥ø‡¥§ ‡¥™‡¥ö‡µç‡¥ö‡¥ï‡µç‡¥ï‡¥±‡¥ø ‡¥ï‡¥ü',
        location: '‡¥§‡µÉ‡¥∂‡µÇ‡µº, ‡¥ï‡µá‡¥∞‡¥≥‡¥Ç',
        phone: '9895123456',
        current_offer: '500 ‡¥∞‡µÇ‡¥™‡¥Ø‡µç‡¥ï‡µç‡¥ï‡µç ‡¥Æ‡µÅ‡¥ï‡¥≥‡¥ø‡µΩ ‡¥µ‡¥æ‡¥ô‡µç‡¥ô‡¥ø‡¥Ø‡¥æ‡µΩ 5% ‡¥°‡¥ø‡¥∏‡µç‡¥ï‡µó‡¥£‡µç‡¥ü‡µç!'
      })
  
      // Product data
      const loading = ref(false)
      const products = ref([
        { id: 1, name: '‡¥§‡¥ï‡µç‡¥ï‡¥æ‡¥≥‡¥ø', price: 30 },
        { id: 2, name: '‡¥µ‡¥¥‡µÅ‡¥§‡¥®', price: 25 },
        { id: 3, name: '‡¥ï‡¥æ‡¥∞‡¥±‡µç‡¥±‡µç', price: 40 },
        { id: 4, name: '‡¥â‡¥≥‡µç‡¥≥‡¥ø', price: 20 },
        { id: 5, name: '‡¥™‡¥ö‡µç‡¥ö‡¥Æ‡µÅ‡¥≥‡¥ï‡µç', price: 60 },
        { id: 6, name: '‡¥ï‡µÅ‡¥ï‡µç‡¥ï‡µÅ‡¥Æ‡µç‡¥™‡µº', price: 15 }
      ])
  
      // Quantities management
      const quantities = reactive({})
      products.value.forEach(product => {
        quantities[product.id] = 0
      })
  
      // Customer details
      const customer = reactive({
        name: '',
        phone: '',
        address: ''
      })
  
      // Bill state
      const showBillPreview = ref(false)
      const billNumber = ref(Math.floor(1000 + Math.random() * 9000))
  
      // Computed properties
      const cartItems = computed(() => 
        products.value.filter(p => quantities[p.id] > 0)
      )
  
      const subtotal = computed(() => 
        cartItems.value.reduce((sum, item) => sum + (quantities[item.id] * item.price), 0)
      )
  
      const discount = computed(() => 
        subtotal.value > 500 ? subtotal.value * 0.05 : 0
      )
  
      const taxableAmount = computed(() => 
        subtotal.value - discount.value
      )
  
      const tax = computed(() => 
        taxableAmount.value * 0.05
      )
  
      const total = computed(() => 
        taxableAmount.value + tax.value
      )
  
      // Methods
      const getProductQuantity = (productId) => {
        return quantities[productId] || 0
      }
  
      const updateQuantity = (productId, newQuantity) => {
        quantities[productId] = Math.max(0, parseFloat(newQuantity) || 0)
      }
  
      const incrementQuantity = (productId) => {
        quantities[productId] = (quantities[productId] || 0) + 1
      }
  
      const decrementQuantity = (productId) => {
        quantities[productId] = Math.max(0, (quantities[productId] || 0) - 1)
      }
  
      const generateBill = () => {
        if (cartItems.value.length === 0) return
        
        showBillPreview.value = true
        billNumber.value = Math.floor(1000 + Math.random() * 9000)
      }
  
      const printBill = () => {
        window.print()
      }
  
      const closeBillPreview = () => {
        showBillPreview.value = false
      }
  
      // Lifecycle hooks
      onMounted(async () => {
        try {
          // Get shop ID from authenticated user or route params
          const shopId = authStore.user?.shop_id || 1 // Default to 1 if not available
          const shopData = await ShopService.getShopDetails(shopId)
          shop.value = {
            ...shop.value,
            ...shopData
          }
        } catch (error) {
          console.error('Error loading shop data:', error)
        }
      })
  
      return {
        shop,
        loading,
        products,
        quantities,
        customer,
        cartItems,
        subtotal,
        discount,
        tax,
        total,
        showBillPreview,
        billNumber,
        getProductQuantity,
        updateQuantity,
        incrementQuantity,
        decrementQuantity,
        generateBill,
        printBill,
        closeBillPreview
      }
    }
  }
  </script>
  
  <style scoped>
  .bill-card {
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  }
  
  @media print {
    body * {
      visibility: hidden;
    }
    #bill-preview, #bill-preview * {
      visibility: visible;
    }
    #bill-preview {
      position: absolute;
      left: 0;
      top: 0;
      width: 100%;
      max-width: 100%;
    }
    .no-print {
      display: none !important;
    }
  }
  </style>
  
</div>



